<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Дашборд</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/">ActiveTracker</a>
    <div class="navbar-nav">
        <a class="nav-link active fw-bold" href="/">Дашборд</a>
        <a class="nav-link" href="/calculator">Калькулятор</a>
        <a class="nav-link" href="/library">Бібліотека</a>
    </div>
  </div>
</nav>

<div class="container">
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card p-3 shadow-sm text-center border-0">
                <h3 class="text-primary">{{ stats.total }}</h3>
                <small class="text-muted">Навантаження (тиждень)</small>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card p-3 shadow-sm text-center border-0">
                <h3 class="text-success">{{ stats.count }}</h3>
                <small class="text-muted">Кількість тренувань</small>
            </div>
        </div>
    </div>

    <div class="card p-4 shadow-sm mb-4 border-0">
        <h5 class="card-title text-secondary">Динаміка активності</h5>
        <canvas id="chart" height="80"></canvas>
    </div>

    <div class="row">
        <div class="col-md-4 mb-3">
            <div class="card p-3 shadow-sm border-0">
                <h5>Додати тренування</h5>
                <form method="POST">
                    <input type="date" name="date" class="form-control mb-2" value="{{ today }}" required>
                    <select name="type" class="form-select mb-2">
                        <option value="Біг">Біг</option>
                        <option value="Зал">Зал</option>
                        <option value="Спорт">Спорт</option>
                    </select>
                    <input type="number" name="duration" class="form-control mb-2" placeholder="Хвилини" required>
                    <input type="number" name="intensity" class="form-control mb-2" placeholder="Інтенсивність (1-5)" min="1" max="5" required>
                    <button class="btn btn-primary w-100">Зберегти</button>
                </form>
            </div>
        </div>

        <div class="col-md-8">
            <div class="card p-3 shadow-sm border-0">
                <h5>Історія</h5>
                <table class="table table-hover">
                    <thead><tr><th>Дата</th><th>Тип</th><th>Час</th><th>Load</th></tr></thead>
                    <tbody>
                        {% for w in workouts[::-1] %}
                        <tr>
                            <td>{{ w.date }}</td>
                            <td><span class="badge bg-secondary">{{ w.type }}</span></td>
                            <td>{{ w.duration }} хв</td>
                            <td><strong>{{ w.load }}</strong></td>
                        </tr>
                        {% else %}
                        <tr><td colspan="4" class="text-center text-muted">Історія пуста</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('chart');
    if (ctx) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: {{ stats.chart_labels | tojson }},
                datasets: [{
                    label: 'Навантаження',
                    data: {{ stats.chart_data | tojson }},
                    borderColor: '#0d6efd',
                    backgroundColor: 'rgba(13, 110, 253, 0.1)',
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true } }
            }
        });
    }
</script>
</body>
</html>